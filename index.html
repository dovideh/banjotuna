<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Banjo Tunings Reference</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>INTERACTIVE BANJO TUNINGS REFERENCE</h1>
            <div class="subtitle">24 Tunings with Fretboard Note Charts, Capo Simulation & SVG Diagrams</div>
            <div class="subtitle">5-String & 4-String Banjo | Organized by Tuning Family</div>
        </header>

        <!-- Control Panel -->
        <div class="control-panel no-print">
            <div class="control-group">
                <label>Tuning Family</label>
                <select id="familyFilter">
                    <option value="all">All Families</option>
                    <option value="c-family">C-Based Tunings</option>
                    <option value="d-family">D-Based Tunings</option>
                    <option value="g-family">G-Based Tunings</option>
                    <option value="other-family">Other (4-String)</option>
                </select>
            </div>

            <div class="control-group">
                <label>Capo Position</label>
                <input type="number" id="capoPosition" min="0" max="12" value="0">
            </div>

            <div class="control-group">
                <label>Fret Count</label>
                <select id="fretCount">
                    <option value="12">12 Frets</option>
                    <option value="15" selected>15 Frets</option>
                    <option value="18">18 Frets</option>
                </select>
            </div>

            <div class="control-group">
                <label>Options</label>
                <div class="checkbox-container">
                    <input type="checkbox" id="showNotesToggle" checked>
                    <span>Show notes on fretboard</span>
                </div>
                <div class="checkbox-container" style="margin-top: 8px;">
                    <input type="checkbox" id="solfegeToggle">
                    <span>Use solfège (Do Re Mi)</span>
                </div>
            </div>

            <div class="control-group">
                <label>Actions</label>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-primary" onclick="window.print()">Print / PDF</button>
                    <button class="btn btn-secondary" onclick="resetSettings()">Reset</button>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs no-print">
            <button class="tab active" data-tab="tunings">Tunings</button>
            <button class="tab" data-tab="fretboards">Fretboards</button>
            <button class="tab" data-tab="chords">Chords</button>
            <button class="tab" data-tab="reference">Reference</button>
            <button class="tab" data-tab="tests">Tests</button>
        </div>

        <!-- Tunings Tab -->
        <div id="tunings-tab" class="tab-content active">
            <div class="reference-box">
                <strong>NOTATION SYSTEM:</strong>
                Notes shown with Scientific Pitch Notation (SPN) subscripts (e.g., G&#8324; = G above middle C)<br>
                String order: 5th (drone) &#8594; 4th &#8594; 3rd &#8594; 2nd &#8594; 1st<br>
                &#916; symbol = changes required from reference tuning | &#8593; = tune up | &#8595; = tune down<br>
                Circle Key: &#9675; = Standard Open String | &#9679; = Changed String<br>
                Display uses mixed notation: Ab, Bb (flats) but C#, D#, F# (sharps) for musical convention
            </div>

            <div id="tuningsContainer"></div>
        </div>

        <!-- Fretboards Tab -->
        <div id="fretboards-tab" class="tab-content">
            <div class="reference-box no-print">
                <strong>FRETBOARD NOTE CHARTS &amp; INVERSIONS:</strong>
                Select a tuning, then choose a chord quality (Major, Dom 7th, Maj 7th, Min 7th) to visualize inversions.<br>
                <strong>Colors:</strong> Blue = Root Form | Red = 1st Inv | Yellow = 2nd Inv | Green = 3rd Inv<br>
                <strong>Shapes:</strong> Triangle = Root/1st | Rectangle = 2nd | Diamond = 3rd<br>
                Toggle between Full Chords and Partials/Dyads. Use filter checkboxes to isolate specific inversions.<br>
                Connector arrows show the dynamic fret distance between shapes based on the tuning interval.
            </div>

            <!-- Chord Inversions Controls (Universal Generator) -->
            <div class="chord-controls no-print" id="inversionControls">
                <div class="chord-control-group">
                    <label>Chord Quality</label>
                    <div class="chord-type-buttons" id="inversionTypeButtons">
                        <button class="chord-type-btn" data-family="MAJOR">Major</button>
                        <button class="chord-type-btn" data-family="DOM7">Dom 7th</button>
                        <button class="chord-type-btn" data-family="MAJ7">Maj 7th</button>
                        <button class="chord-type-btn" data-family="MIN7">Min 7th</button>
                    </div>
                </div>

                <div class="chord-control-group" id="inversionKeyContainer" style="display: none;">
                    <label>Root Note</label>
                    <div class="key-buttons" id="inversionKeyButtons">
                        <button class="key-btn" data-key="C">C</button>
                        <button class="key-btn" data-key="C#">C#</button>
                        <button class="key-btn" data-key="D">D</button>
                        <button class="key-btn" data-key="D#">D#</button>
                        <button class="key-btn" data-key="E">E</button>
                        <button class="key-btn" data-key="F">F</button>
                        <button class="key-btn" data-key="F#">F#</button>
                        <button class="key-btn active" data-key="G">G</button>
                        <button class="key-btn" data-key="G#">G#</button>
                        <button class="key-btn" data-key="A">A</button>
                        <button class="key-btn" data-key="A#">A#</button>
                        <button class="key-btn" data-key="B">B</button>
                    </div>
                </div>

                <div class="inversion-options-row" id="inversionOptionsContainer" style="display: none;">
                    <div class="chord-control-group">
                        <label>Voicing Mode</label>
                        <div class="voicing-mode-buttons" id="voicingModeButtons">
                            <button class="voicing-mode-btn active" data-mode="full">Full Chords</button>
                            <button class="voicing-mode-btn" data-mode="partial">Partials / Dyads</button>
                        </div>
                    </div>

                    <div class="chord-control-group">
                        <label>Filter Inversions</label>
                        <div class="inversion-filter-checks" id="inversionFilterChecks">
                            <label class="inversion-check blue"><input type="checkbox" value="Root Form"> Root</label>
                            <label class="inversion-check red"><input type="checkbox" value="1st Inversion"> 1st Inv</label>
                            <label class="inversion-check yellow"><input type="checkbox" value="2nd Inversion"> 2nd Inv</label>
                            <label class="inversion-check green"><input type="checkbox" value="3rd Inversion"> 3rd Inv</label>
                        </div>
                    </div>

                    <div class="chord-control-group">
                        <label>Playback</label>
                        <div class="audio-controls">
                            <div class="audio-mode-toggle">
                                <label><input type="radio" name="audioPlayMode" value="arpeggio" checked> Arpeggio</label>
                                <label><input type="radio" name="audioPlayMode" value="block"> Block</label>
                            </div>
                        </div>
                    </div>

                    <div class="chord-control-group">
                        <label>Metronome</label>
                        <div class="metronome-controls">
                            <input type="number" id="metronomeBPM" min="40" max="200" value="80" class="bpm-input">
                            <span class="bpm-label">BPM</span>
                            <button id="metronomeToggle" class="btn btn-secondary metronome-btn">Start</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="fretboard-layout">
                <!-- Tuning Selector (Left Side) -->
                <div class="tuning-selector no-print">
                    <div class="tuning-selector-header">Select Tuning</div>
                    <div class="tuning-selector-filter">
                        <select id="fretboardFamilyFilter">
                            <option value="all">All Families</option>
                            <option value="c-family">C-Based</option>
                            <option value="d-family">D-Based</option>
                            <option value="g-family">G-Based</option>
                            <option value="other-family">Other (4-String)</option>
                        </select>
                    </div>
                    <div class="tuning-list" id="tuningList"></div>
                </div>

                <!-- Fretboard Display (Right Side) -->
                <div class="fretboard-display">
                    <div id="fretboardContainer"></div>
                </div>
            </div>
        </div>

        <!-- Chords Tab -->
        <div id="chords-tab" class="tab-content">
            <div class="chord-info-box no-print">
                <strong>CHORD DIAGRAMS:</strong>
                Vertical lines = strings (5th on left to 1st on right) | Horizontal lines = frets<br>
                &#9675; = Open string | &#10005; = Muted string | Circled numbers = finger positions<br>
                Thick top line = nut | Numbers below strings show chord degrees (1=root, 3=third, 5=fifth)<br>
                Root notes shown with filled circles for easy identification
            </div>

            <div class="chord-controls no-print">
                <div class="chord-control-group">
                    <label>Tuning</label>
                    <select id="chordTuningSelect" style="padding: 8px; font-size: 14px; min-width: 150px;">
                    </select>
                </div>

                <div class="chord-control-group">
                    <label>View Mode</label>
                    <div class="view-mode-buttons" id="viewModeButtons">
                        <button class="view-mode-btn active" data-mode="single">Single Key</button>
                        <button class="view-mode-btn" data-mode="grid">All Keys Grid</button>
                    </div>
                </div>

                <div class="chord-control-group" id="keyButtonsContainer">
                    <label>Key</label>
                    <div class="key-buttons" id="keyButtons">
                        <!-- Keys populated by JS -->
                    </div>
                </div>

                <div class="chord-control-group">
                    <label>Chord Type</label>
                    <div class="chord-type-buttons" id="chordTypeButtons">
                        <!-- Chord types populated by JS -->
                    </div>
                </div>

                <div class="chord-control-group">
                    <label>Finger Notation</label>
                    <div class="finger-toggle">
                        <label>
                            <input type="radio" name="fingerNotation" value="numbers" checked>
                            1-2-3-4
                        </label>
                        <label>
                            <input type="radio" name="fingerNotation" value="pima">
                            PIMA
                        </label>
                    </div>
                </div>
            </div>

            <div id="chordContainer" class="chord-grid">
                <!-- Chord diagrams rendered here -->
            </div>
        </div>

        <!-- Reference Tab -->
        <div id="reference-tab" class="tab-content">
            <div class="reference-section">
                <h3>Fret Reference for Relative Tuning</h3>

                <div class="fret-reference-box blue">
                    <h4>TUNING 5TH STRING:</h4>
                    <ul>
                        <li><strong>E:</strong> 1st string, 2nd fret when 1st = C (Little Birdie)</li>
                        <li><strong>F:</strong> 1st string, 3rd fret when 1st = C (F Tuning, East Virginia)</li>
                        <li><strong>F#:</strong> 1st string, 4th fret when 1st = C</li>
                        <li><strong>G:</strong> 1st string, 5th fret when 1st = C OR 4th string, 5th fret</li>
                        <li><strong>A:</strong> 1st string, 7th fret when 1st = C (Open D, D Modal)</li>
                    </ul>
                </div>

                <div class="fret-reference-box red">
                    <h4>TUNING 2ND STRING:</h4>
                    <ul>
                        <li><strong>A:</strong> 3rd string, 2nd fret when 3rd = G (G Variant, Moonshiner)</li>
                        <li><strong>B:</strong> When 2nd string is at C, fret 2nd string at 2nd fret = B (Open G)</li>
                        <li><strong>C:</strong> 3rd string, 5th fret when 3rd = G (Double C, Sawmill)</li>
                        <li><strong>C#:</strong> When 2nd string is at C, fret at 1st = C# (Open A)</li>
                    </ul>
                </div>

                <div class="fret-reference-box green">
                    <h4>TUNING OTHER STRINGS:</h4>
                    <ul>
                        <li><strong>1st String:</strong> Match to target pitch or use electronic tuner</li>
                        <li><strong>3rd String:</strong> Usually tuned relative to 4th string (perfect 4th interval)</li>
                        <li><strong>4th String:</strong> Foundation - tune first with electronic tuner</li>
                    </ul>
                </div>
            </div>

            <div class="reference-section">
                <h3>Capo Transposition Chart</h3>

                <table class="capo-chart">
                    <thead>
                        <tr>
                            <th>Base Tuning</th>
                            <th>Capo 2</th>
                            <th>Capo 3</th>
                            <th>Capo 4</th>
                            <th>Capo 5</th>
                            <th>Capo 7</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Open G</strong></td>
                            <td>A</td>
                            <td>Bb</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                        </tr>
                        <tr>
                            <td><strong>Double C</strong></td>
                            <td>D</td>
                            <td>Eb</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                        </tr>
                        <tr>
                            <td><strong>Open D</strong></td>
                            <td>E</td>
                            <td>F</td>
                            <td>F#</td>
                            <td>G</td>
                            <td>A</td>
                        </tr>
                        <tr>
                            <td><strong>G Modal</strong></td>
                            <td>A</td>
                            <td>Bb</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                        </tr>
                    </tbody>
                </table>

                <div class="reference-box" style="margin-top: 20px;">
                    <strong>5TH STRING SPIKES (when 5th string = G):</strong><br>
                    7th fret = A | 9th fret = B | 10th fret = C | 12th fret = D
                </div>
            </div>

            <div class="reference-section">
                <h3>String Range Overview</h3>
                <ul>
                    <li><strong>5th String Range:</strong> E&#8324; (Little Birdie) &#8594; A&#8324; (Open D, Open A, D Modal)</li>
                    <li><strong>4th String Range:</strong> C&#8322; (Minstrel family) &#8594; F&#8323; (East Virginia)</li>
                    <li><strong>3rd String Range:</strong> F&#8323; (Standard F, Minstrel) &#8594; A&#8324; (Open A)</li>
                    <li><strong>2nd String Range:</strong> A&#8323; (Multiple tunings) &#8594; C#&#8324; (Open A)</li>
                    <li><strong>1st String Range:</strong> C&#8324; (Standard F, Darling Cora) &#8594; E&#8324; (Cackling Hen, Open A)</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>HIGH TENSION WARNING:</h4>
                <p><strong>Open A</strong> and <strong>Open D</strong> require significantly higher string tension than Open G.
                Use lighter gauge strings (.009 or .010 for the 1st string) and tune up gradually.
                Check your bridge position and neck relief when using these tunings regularly.</p>
            </div>

            <div class="reference-section">
                <h3>Quick Tuning Strategies</h3>
                <ol>
                    <li><strong>Start from a known tuning:</strong> Most players keep their banjo in Open G and adjust from there</li>
                    <li><strong>Use electronic tuners:</strong> Chromatic tuners are essential for accuracy with octave notation</li>
                    <li><strong>Relative tuning:</strong> Use fret references when tuning by ear</li>
                    <li><strong>String tension:</strong> High tunings (Open A, Open D) require lighter gauge strings</li>
                    <li><strong>Bridge setup:</strong> Moving between tuning families may require bridge repositioning</li>
                    <li><strong>Note your bridge position:</strong> Mark or measure bridge placement for each tuning family</li>
                    <li><strong>Tune gradually:</strong> When tuning up to high-tension tunings, go slowly to avoid breakage</li>
                </ol>
            </div>

            <div class="legend">
                Complete Banjo Tunings Reference | 24 Tunings Across 4 Families<br>
                Symbols: &#8593; = tune up | &#8595; = tune down | &#916; = change from reference | SPN = Scientific Pitch Notation<br>
                &#11088; = Most common | &#9888; = Requires special consideration (string tension, setup)
            </div>
        </div>

        <!-- Tests Tab -->
        <div id="tests-tab" class="tab-content">
            <div class="reference-box">
                <strong>VALIDATION &amp; TESTS:</strong>
                Run the built-in test suite to validate chord shape generation, inversion classification, and connector logic.
                Tests verify the Universal Shape Generator against known chord theory.
            </div>

            <div class="test-controls no-print">
                <button id="runTestsBtn" class="btn btn-primary">Run All Tests</button>
            </div>

            <div id="testResultsContainer" class="test-results-container">
                <p class="test-placeholder">Click "Run All Tests" to validate the chord inversion engine.</p>
            </div>

            <div class="reference-section">
                <h3>Inversion Color Legend</h3>
                <div class="inversion-legend">
                    <div class="legend-item">
                        <span class="legend-swatch" style="background: #3366cc;"></span>
                        <strong>Root Form (Blue)</strong> — Bass note is the Root (1). Triangle overlay. "F Shape" alias.
                    </div>
                    <div class="legend-item">
                        <span class="legend-swatch" style="background: #cc3333;"></span>
                        <strong>1st Inversion (Red)</strong> — Bass note is the 3rd (or &#9837;3). Triangle overlay. "D Shape" alias.
                    </div>
                    <div class="legend-item">
                        <span class="legend-swatch" style="background: #cc9900;"></span>
                        <strong>2nd Inversion (Yellow)</strong> — Bass note is the 5th. Rectangle overlay. "Barre Shape" alias.
                    </div>
                    <div class="legend-item">
                        <span class="legend-swatch" style="background: #339933;"></span>
                        <strong>3rd Inversion (Green)</strong> — Bass note is the 7th (&#9837;7 or 7). Diamond overlay. 7th chords only.
                    </div>
                </div>
            </div>

            <div class="reference-section">
                <h3>Test Case Schema (JSON)</h3>
                <pre class="code-block">{
  "test_id": "TC_001",
  "description": "Verify F Major Root Form Logic in Standard G",
  "setup": {
    "tuning_id": "Open G",
    "root_note": "F",
    "chord_quality": "MAJOR"
  },
  "expectations": {
    "classification": {
      "shape_name": "Root Form",
      "expected_color": "Blue",
      "bass_interval": 1
    },
    "voicing": {
      "frets": [3, 2, 1, 3],
      "intervals": [1, 3, 5, 1]
    },
    "movable_logic": {
      "base_shape_alias": "F Shape",
      "fret_offset": 0
    }
  }
}</pre>
            </div>
        </div>
    </div>


    <!-- JavaScript files (order matters) -->
    <script src="js/utils.js"></script>
    <script src="js/tunings.js"></script>
    <script src="js/chords.js"></script>
    <script src="js/inversions.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/fretboard.js"></script>
    <script src="js/tests.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
